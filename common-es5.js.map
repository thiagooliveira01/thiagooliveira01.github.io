{"version":3,"sources":["./src/app/shared/componentes/base-resource-form/base-resource-form.component.ts","./src/app/shared/componentes/base-resource-list/base-resource-list.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsE;AACF;AACX;AAGiB;AAE/B;AAEf;AAE5B;IAWE,mCACY,QAAkB,EACrB,QAAW,EACR,eAAsC,EACtC,oBAAqC;QAHrC,aAAQ,GAAR,QAAQ,CAAU;QACrB,aAAQ,GAAR,QAAQ,CAAG;QACR,oBAAe,GAAf,eAAe,CAAuB;QACtC,yBAAoB,GAApB,oBAAoB,CAAiB;QAXjD,wBAAmB,GAAa,IAAI,CAAC;QACrC,mBAAc,GAAY,KAAK,CAAC;QAY9B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,8DAAc,CAAC,CAAC;QAC/C,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,sDAAM,CAAC,CAAC;QACxC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,0DAAW,CAAC,CAAC;IACtD,CAAC;IAEC,4CAAQ,GAAR;QACE,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED,yDAAqB,GAArB;QACE,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED,8CAAU,GAAV;QACE,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;QAE3B,IAAI,IAAI,CAAC,aAAa,IAAI,KAAK;YAC7B,IAAI,CAAC,cAAc,EAAE,CAAC;aACnB,MAAM;YACT,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IAED,kBAAkB;IACR,oDAAgB,GAA1B;QACE,IAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,KAAK;YACzC,IAAI,CAAC,aAAa,GAAG,KAAK;;YAE1B,IAAI,CAAC,aAAa,GAAG,MAAM;IAC/B,CAAC;IAES,iDAAa,GAAvB;IAEA,CAAC;IAES,gDAAY,GAAtB;QAAA,iBAaC;QAZC,IAAG,IAAI,CAAC,aAAa,IAAI,MAAM,EAAE;YAC/B,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CACtB,gEAAS,CAAC,gBAAM,IAAI,YAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAA/C,CAA+C,CAAC,CACrE;iBACA,SAAS,CACR,UAAC,QAAQ;gBACP,KAAI,CAAC,QAAQ,GAAG,QAAQ;gBACxB,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAC,kCAAkC;YAC3E,CAAC,EACD,UAAC,KAAK,IAAK,YAAK,CAAC,8BAA8B,CAAC,EAArC,CAAqC,CACjD;SACF;IACH,CAAC;IAES,gDAAY,GAAtB;QACE,IAAI,IAAI,CAAC,aAAa,IAAI,KAAK;YAC7B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;aACxC;YACF,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;SAC1C;IACH,CAAC;IAES,qDAAiB,GAA3B;QACE,OAAO,MAAM,CAAC;IAChB,CAAC;IACS,oDAAgB,GAA1B;QACE,OAAO,QAAQ,CAAC;IAClB,CAAC;IAES,kDAAc,GAAxB;QAAA,iBAOC;QANC,IAAM,QAAQ,GAAO,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAExE,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,CAC7C,kBAAQ,IAAI,YAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,EAAhC,CAAgC,EAC5C,eAAK,IAAI,YAAI,CAAC,eAAe,CAAC,KAAK,CAAC,EAA3B,CAA2B,CACrC;IACH,CAAC;IAES,kDAAc,GAAxB;QAAA,iBAOC;QANC,IAAM,QAAQ,GAAO,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAExE,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,CAC7C,kBAAQ,IAAI,YAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,EAAhC,CAAgC,EAC5C,eAAK,IAAI,YAAI,CAAC,eAAe,CAAC,KAAK,CAAC,EAA3B,CAA2B,CACrC,CAAC;IACJ,CAAC;IAES,qDAAiB,GAA3B,UAA4B,QAAW;QAAvC,iBASC;QARC,6CAAM,CAAC,OAAO,CAAC,qCAAqC,CAAC,CAAC;QAEtD,IAAM,iBAAiB,GAAW,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAEzE,8DAA8D;QAC9D,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,iBAAiB,EAAE,EAAC,kBAAkB,EAAE,IAAI,EAAC,CAAC,CAAC,IAAI,CAC3E,cAAM,YAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,iBAAiB,EAAE,QAAQ,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,EAA9D,CAA8D,CACrE;IACH,CAAC;IAES,mDAAe,GAAzB,UAA0B,KAAK;QAC7B,6CAAM,CAAC,KAAK,CAAC,iDAAiD,CAAC,CAAC;QAEhE,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAE5B,IAAG,KAAK,CAAC,MAAM,KAAK,GAAG;YACrB,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;;YAE1D,IAAI,CAAC,mBAAmB,GAAG,CAAC,wDAAwD,CAAC,CAAC;IAC1F,CAAC;;gBA7GqB,sDAAQ;;gBAED,kFAAkB;;;IA+GjD,gCAAC;CAAA;AA7H8C;;;;;;;;;;;;;ACR/C;AAAA;AAAA;AAA0E;AAE1E;IAIE,kCAAoB,eAAsC;QAAtC,oBAAe,GAAf,eAAe,CAAuB;QAF1D,cAAS,GAAS,EAAE,CAAC;IAE0C,CAAC;IAEhE,2CAAQ,GAAR;QAAA,iBAKC;QAJC,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC,SAAS,CACrC,mBAAS,IAAI,YAAI,CAAC,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAI,QAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,EAAX,CAAW,CAAE,EAAtD,CAAsD,EACnE,eAAK,IAAI,YAAK,CAAC,0BAA0B,CAAC,EAAjC,CAAiC,CAC3C;IACH,CAAC;IAED,iDAAc,GAAd,UAAe,QAAY;QAA3B,iBASC;QARC,IAAM,cAAc,GAAG,OAAO,CAAC,qCAAqC,CAAC,CAAC;QAEtE,IAAI,cAAc,EAAC;YACnB,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,SAAS,CAChD,cAAK,YAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC,iBAAO,IAAI,cAAO,IAAI,QAAQ,EAAnB,CAAmB,CAAC,EAAtE,CAAsE,EAC3E,cAAK,YAAK,CAAC,wBAAwB,CAAC,EAA/B,CAA+B,CACrC;SACA;IACH,CAAC;;gBAlBoC,kFAAkB;;IAoBzD,+BAAC;CAAA;AAxB6C","file":"common-es5.js","sourcesContent":["import { OnInit, AfterContentChecked, Injector } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\r\nimport { ActivatedRoute, Router } from \"@angular/router\";\r\n\r\nimport { BaseResourceModel } from \"../../models/base-resource.model\";\r\nimport { BaseResouceService } from \"../../servicos/base-resource.service\";\r\n\r\nimport { switchMap } from \"rxjs/operators\";\r\n\r\nimport toastr from \"toastr\";\r\n\r\nexport abstract class BaseResourceFormComponent<T extends BaseResourceModel> implements OnInit, AfterContentChecked {\r\n  currentAction: string;\r\n  resourceForm: FormGroup;\r\n  pageTitle: string;\r\n  serverErrorMessages: string[] = null;\r\n  submittingForm: boolean = false;\r\n\r\n  protected route: ActivatedRoute;\r\n  protected router: Router;\r\n  protected formBuilder: FormBuilder;\r\n\r\n  constructor(\r\n    protected injector: Injector,\r\n    public resource: T,\r\n    protected resourceService: BaseResouceService<T>,\r\n    protected jsonDataToResourceFn: (jsonData) => T\r\n) { \r\n    this.route = this.injector.get(ActivatedRoute);\r\n    this.router = this.injector.get(Router);\r\n    this.formBuilder = this.injector.get(FormBuilder);\r\n}\r\n\r\n  ngOnInit() {\r\n    this.setCurrentAction();\r\n    this.buildResourceForm();\r\n    this.loadResource();\r\n  }\r\n\r\n  ngAfterContentChecked(){\r\n    this.setPageTitle();\r\n  }\r\n\r\n  submitForm(){\r\n    this.submittingForm = true;\r\n\r\n    if (this.currentAction == 'new')\r\n      this.createResource();\r\n    else //edit\r\n      this.updateResource();\r\n  }\r\n\r\n  //metodos privados\r\n  protected setCurrentAction(){\r\n    if(this.route.snapshot.url[0].path == \"new\")\r\n      this.currentAction = 'new'\r\n    else\r\n      this.currentAction = 'edit'\r\n  }\r\n\r\n  protected buildResource(){\r\n\r\n  }\r\n\r\n  protected loadResource(){\r\n    if(this.currentAction == 'edit') {\r\n      this.route.paramMap.pipe(\r\n        switchMap(params => this.resourceService.getById(+params.get(\"id\")))\r\n      )\r\n      .subscribe(\r\n        (resource) =>{\r\n          this.resource = resource\r\n          this.resourceForm.patchValue(resource) //carregando dados para formulario\r\n        },\r\n        (error) => alert('Ocorreu um erro no servidor.')\r\n      )\r\n    }\r\n  }\r\n\r\n  protected setPageTitle(){\r\n    if (this.currentAction == 'new')  \r\n      this.pageTitle = this.creationPageTitle();\r\n    else{\r\n      this.pageTitle = this.editionPageTitle();\r\n    }\r\n  }\r\n\r\n  protected creationPageTitle(): string{\r\n    return \"Novo\";\r\n  }\r\n  protected editionPageTitle(): string{\r\n    return \"Edição\";\r\n  }   \r\n\r\n  protected createResource(){\r\n    const resource : T = this.jsonDataToResourceFn(this.resourceForm.value);\r\n\r\n    this.resourceService.create(resource).subscribe(\r\n      resource => this.actionsForSuccess(resource),\r\n      error => this.actionsForError(error)\r\n    )\r\n  }\r\n\r\n  protected updateResource(){\r\n    const resource : T = this.jsonDataToResourceFn(this.resourceForm.value);\r\n\r\n    this.resourceService.update(resource).subscribe(\r\n      resource => this.actionsForSuccess(resource),\r\n      error => this.actionsForError(error)\r\n    );\r\n  }\r\n\r\n  protected actionsForSuccess(resource: T){\r\n    toastr.success('Solicitação processada com sucesso!');\r\n\r\n    const baseComponentPath: string = this.route.snapshot.parent.url[0].path;\r\n\r\n    //volta para categorias e re-abre o formulario na rota de edit\r\n    this.router.navigateByUrl(baseComponentPath, {skipLocationChange: true}).then(\r\n      () => this.router.navigate([baseComponentPath, resource.id, 'edit'])\r\n    )\r\n  }\r\n\r\n  protected actionsForError(error){\r\n    toastr.error('Ocorreu um erro ao processar a sua solicitação!');\r\n\r\n    this.submittingForm = false;\r\n\r\n    if(error.status === 422)\r\n      this.serverErrorMessages = JSON.parse(error._body).errors;\r\n    else\r\n      this.serverErrorMessages = [\"Falha na comunicação com o servidor. Tente mais tarde.\"];\r\n  }\r\n\r\n  protected abstract buildResourceForm(): void;\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\nimport { BaseResourceModel } from \"../../models/base-resource.model\";\r\nimport { BaseResouceService } from \"../../servicos/base-resource.service\";\r\n\r\nexport abstract class BaseResouceListComponent<T extends BaseResourceModel> implements OnInit {\r\n\r\n  resources : T[] = [];\r\n\r\n  constructor(private resourceService: BaseResouceService<T> ) { }\r\n\r\n  ngOnInit() {\r\n    this.resourceService.getall().subscribe(\r\n      resources => this.resources = resources.sort((a, b)=> b.id - a.id ),\r\n      error => alert('Erro ao carregar a lista')\r\n    )\r\n  }\r\n\r\n  deleteResource(resource : T){\r\n    const confirmaDelete = confirm('Deseja realmente excluir este item?');\r\n\r\n    if (confirmaDelete){\r\n    this.resourceService.delete(resource.id).subscribe(\r\n      ()=> this.resources = this.resources.filter(element => element != resource),\r\n      ()=> alert('Erro ao tentar excluir')\r\n    )\r\n    }\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}